# Edit Routine Feature - User Flow Documentation

## User Interface Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Routines List Screen                      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Routine 1                              [3 exercises]â”‚    â”‚
â”‚  â”‚  Description of routine                               â”‚    â”‚
â”‚  â”‚                                [â–¶] [âœ] [ğŸ—‘]          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â¬‡ (User clicks edit button)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Edit Routine Screen                       â”‚
â”‚                                                              â”‚
â”‚  Routine Name: [____Leg Day____] â† Pre-filled               â”‚
â”‚                                                              â”‚
â”‚  Description:  [Lower body workout] â† Pre-filled            â”‚
â”‚                                                              â”‚
â”‚  Exercises                                    [+ Add]        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â‰¡ Squats                            [âœ] [ğŸ—‘]       â”‚    â”‚
â”‚  â”‚   3 sets Ã— 10 reps @ 100kg                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â‰¡ Leg Press                         [âœ] [ğŸ—‘]       â”‚    â”‚
â”‚  â”‚   4 sets Ã— 12 reps                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚                    [Update Routine]                          â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Interaction Details

### 1. Accessing Edit Screen
**From**: Routines List Screen  
**Action**: Tap edit (pencil) icon on any routine card  
**Result**: Navigate to Edit Routine Screen with pre-populated data

### 2. Editing Routine Name
**Field**: Routine Name (Required)  
**Validation**: 
- Cannot be empty
- Cannot be only whitespace
**Error Message**: "Routine name cannot be empty"

### 3. Editing Description
**Field**: Description (Optional)  
**Validation**: None required  
**Behavior**: Saves as null if empty

### 4. Managing Exercises

#### Adding Exercise
```
Tap [+ Add] â†’ Exercise Picker â†’ Configure Dialog â†’ Exercise Added
```

**Configure Dialog Fields**:
- Sets (Required, positive integer)
- Reps (Required, positive integer)
- Weight (Optional, positive decimal)
- Rest Time (Optional, integer seconds)

#### Editing Exercise
```
Tap [âœ] on exercise â†’ Configure Dialog (pre-filled) â†’ Save changes
```

#### Removing Exercise
```
Tap [ğŸ—‘] on exercise â†’ Exercise removed â†’ Orders updated
```

#### Reordering Exercises
```
Drag â‰¡ handle â†’ Move to new position â†’ Release â†’ Orders updated
```

### 5. Validation States

#### Valid State
- Name is not empty
- At least one exercise exists
- All exercise fields are valid
- â†’ "Update Routine" button enabled

#### Invalid States

**Empty Name**:
```
âš ï¸ "Routine name cannot be empty"
```

**No Exercises**:
```
âš ï¸ "Please add at least one exercise"
```

**Invalid Sets**:
```
âš ï¸ "Please enter a valid number of sets"
```

**Invalid Reps**:
```
âš ï¸ "Please enter a valid number of reps"
```

**Invalid Weight**:
```
âš ï¸ "Weight must be a positive number"
```

### 6. Saving Changes

#### Success Flow
```
Tap [Update Routine] â†’ Loading state â†’ Database update â†’ 
Success message â†’ Navigate back to list
```

**Success Message**:
```
âœ… "Routine updated successfully!"
```

#### Error Flow
```
Tap [Update Routine] â†’ Loading state â†’ Database error â†’ 
Error message â†’ Stay on edit screen
```

**Error Message**:
```
âŒ "Failed to update routine: [error details]"
```

### 7. Loading States

During save operation:
- "Update Routine" button shows loading indicator
- Button is disabled
- Form inputs remain enabled (can cancel)

## Visual States

### Before Edit
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Morning Workout    [5 exercises]â”‚
â”‚ Quick morning routine           â”‚
â”‚                  [â–¶] [âœ] [ğŸ—‘]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### During Edit
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Edit Routine                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Routine Name: [Morning Workout]          â”‚
â”‚ Description:  [Quick morning routine]    â”‚
â”‚                                           â”‚
â”‚ Exercises:                    [+ Add]     â”‚
â”‚ â‰¡ Push-ups      3Ã—15         [âœ] [ğŸ—‘]   â”‚
â”‚ â‰¡ Pull-ups      3Ã—10         [âœ] [ğŸ—‘]   â”‚
â”‚ ...                                       â”‚
â”‚                                           â”‚
â”‚          [Update Routine]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### After Edit Success
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Morning Workout    [6 exercises]â”‚  â† Updated count
â”‚ Enhanced morning routine        â”‚  â† Updated description
â”‚                  [â–¶] [âœ] [ğŸ—‘]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Routine updated successfully!
```

## Keyboard Navigation

1. **Tab Order**:
   - Routine Name â†’ Description â†’ Add Exercise â†’ Exercise 1 Edit â†’ Exercise 1 Delete â†’ ...

2. **Enter Key**:
   - In text fields: Move to next field
   - On "Update Routine": Submit form

3. **Escape Key**:
   - Close dialogs
   - Return to previous screen (with confirmation if changes made)

## Accessibility Features

- **Screen Reader Support**: All buttons and fields have semantic labels
- **Color Indicators**: 
  - Green for success (âœ…)
  - Red for errors (âŒ)
  - Blue for actions (âœ, +)
- **Icon + Text**: Icons paired with text for clarity
- **Touch Targets**: Minimum 48x48 dp for all interactive elements

## Error Prevention

1. **Validation on Input**: Real-time feedback as user types
2. **Clear Requirements**: Labels indicate required fields
3. **Confirmation Dialogs**: For destructive actions (removing exercises)
4. **Undo Support**: Can navigate back without saving
5. **Auto-save Draft**: (Future enhancement)

## Performance Considerations

1. **Lazy Loading**: Only load exercise picker when needed
2. **Debounced Validation**: Validate after user stops typing
3. **Optimistic Updates**: UI updates before database confirmation
4. **Caching**: Exercise data cached for picker
5. **Minimal Rebuilds**: Only affected widgets rebuild

## Mobile-Specific Behaviors

### iOS
- Pull-to-refresh on lists
- Swipe-back gesture
- Native keyboard handling
- Haptic feedback on actions

### Android
- Material Design ripple effects
- Back button handling
- Floating action button styling
- Snackbar notifications

## Edge Cases Handled

1. **Empty Exercises List**: Show placeholder with "Add Exercise" prompt
2. **Long Names**: Ellipsis truncation with full text on tap
3. **Many Exercises**: Scrollable list with proper keyboard handling
4. **Offline Mode**: Queue updates for when online
5. **Concurrent Edits**: Last-write-wins with timestamp check
6. **Network Errors**: Retry option with clear messaging

## Future Enhancements

These are NOT implemented but documented for future reference:

1. **Undo/Redo**: History stack for changes
2. **Auto-save**: Periodic saves as user types
3. **Change Tracking**: Visual indicators for modified fields
4. **Duplicate Routine**: Quick copy with edit
5. **Templates**: Save as template for reuse
6. **Sharing**: Share routine with other users
7. **Import/Export**: Backup and restore routines
8. **Voice Input**: Dictation for descriptions
9. **Rich Text**: Formatting in descriptions
10. **Exercise Notes**: Per-exercise instructions
